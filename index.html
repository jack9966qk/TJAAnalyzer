<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TJA Analyzer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <h1>TJA Analyzer</h1>
        
        <div id="source-controls">
            <fieldset id="manual-load-fieldset" class="source-fieldset">
                <legend>Manual Chart Load</legend>
                <div class="controls">
                    <div class="control-group">
                        <label for="tja-file-picker">Load TJA File:</label>
                        <input type="file" id="tja-file-picker" accept=".tja">
                        <button id="clear-manual-btn" disabled>Clear</button>
                    </div>
                    <div id="difficulty-selector-container" hidden>
                        <div class="control-group">
                            <label for="difficulty-selector">Difficulty:</label>
                            <select id="difficulty-selector"></select>
                        </div>
                    </div>
                </div>
            </fieldset>

            <div class="separator">OR</div>

            <fieldset id="event-stream-fieldset" class="source-fieldset">
                <legend>Event Stream</legend>
                <div class="controls">
                    <div class="control-group">
                        <label>Host: <input type="text" id="host-input" value="127.0.0.1"></label>
                    </div>
                    <div class="control-group">
                        <label>Port: <input type="number" id="port-input" value="2354"></label>
                    </div>
                    <div class="control-group">
                        <button id="connect-btn">Connect</button>
                        <button id="test-stream-btn">Test Stream</button>
                    </div>
                </div>
            </fieldset>
        </div>

        <div id="status-display"></div>

        <div id="sticky-header">
            <fieldset id="display-controls">
                <legend>Display Mode</legend>
                <div class="controls">
                    <label>View Mode: </label>
                    <label>
                        <input type="radio" name="viewMode" value="original" checked> Original
                    </label>
                    <label>
                        <input type="radio" id="judgements-radio" name="viewMode" value="judgements"> Judgements
                    </label>
                    <label>
                        <input type="radio" id="judgements-underline-radio" name="viewMode" value="judgements-underline"> Judgements (Underline)
                    </label>
                    <label style="margin-left: 20px;">
                        <input type="checkbox" id="collapse-loop-checkbox"> Collapse Loops
                    </label>
                    <span id="loop-controls" style="display:none; margin-left: 10px; padding-left: 10px; border-left: 1px solid #888;">
                         <label style="margin-right: 5px;"><input type="checkbox" id="loop-auto" checked> Auto</label>
                         <button id="loop-prev" style="width: 24px; padding: 0;">&lt;</button>
                         <span id="loop-counter" style="margin: 0 5px; font-family: monospace;">-</span>
                         <button id="loop-next" style="width: 24px; padding: 0;">&gt;</button>
                    </span>
                </div>
            </fieldset>

            <div id="note-stats-display"></div>
        </div>

        <div class="canvas-container">
            <canvas id="chart-canvas"></canvas>
        </div>
    </div>
    <script type="module" src="dist/src/main.js"></script>
</body>
</html>